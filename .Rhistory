load("/Users/lesliehuang/un_findk_40.RData")
save.image("un_tuning_combined.RData")
load("/Users/lesliehuang/un_findk_50.RData")
load("/Users/lesliehuang/un_findk_51.RData")
load("/Users/lesliehuang/un_findk_53.RData")
load("/Users/lesliehuang/un_findk_58.RData")
load("/Users/lesliehuang/un_tuning_combined.RData")
save.image("un_tuning_combined.RData")
View(result_20)
load("/Users/lesliehuang/Desktop/un_findk1.RData")
View(result)
View(result_40)
View(result)
View(result_40)
View(result)
View(result_50)
View(result)
load("/Users/lesliehuang/un_findk_55.RData")
load("/Users/lesliehuang/un_findk_57.RData")
load("/Users/lesliehuang/un_findk_60.RData")
load("/Users/lesliehuang/un_findk_61.RData")
load("/Users/lesliehuang/un_findk_63.RData")
load("/Users/lesliehuang/un_findk_65.RData")
load("/Users/lesliehuang/un_findk_68.RData")
load("/Users/lesliehuang/un_findk_75.RData")
load("/Users/lesliehuang/un_tuning_combined.RData")
save.image("un_tuning_combined.RData")
load("/Users/lesliehuang/un_findk_95.RData")
load("/Users/lesliehuang/un_findk_93.RData")
load("/Users/lesliehuang/un_findk_90.RData")
load("/Users/lesliehuang/un_findk_89.RData")
load("/Users/lesliehuang/un_findk_87.RData")
load("/Users/lesliehuang/un_findk_82.RData")
load("/Users/lesliehuang/un_findk_81.RData")
load("/Users/lesliehuang/un_findk_79.RData")
load("/Users/lesliehuang/un_findk_77.RData")
load("/Users/lesliehuang/un_findk_72.RData")
load("/Users/lesliehuang/un_findk_69.RData")
load("/Users/lesliehuang/un_findk_68.RData")
load("/Users/lesliehuang/un_findk_64.RData")
load("/Users/lesliehuang/un_findk_47.RData")
load("/Users/lesliehuang/un_findk_42.RData")
load("/Users/lesliehuang/un_findk_80.RData")
load("/Users/lesliehuang/un_findk_85.RData")
load("/Users/lesliehuang/un_tuning_combined.RData")
save.image("un_tuning_combined.RData")
load("/Users/lesliehuang/perplexity_65.RData")
perplexity_test_60
load("/Users/lesliehuang/perplexitytest_60.RData")
load("/Users/lesliehuang/perplexitytest_65.RData")
load("/Users/lesliehuang/perplexitytest_70.RData")
load("/Users/lesliehuang/perplexitytest_75.RData")
load("/Users/lesliehuang/perplexitytest_80.RData")
save.image("perplexitytest_combined.RData")
View(perplexity_results_55)
View(perplexity_results_55)
load("/Users/lesliehuang/kfold_perplexity_60.RData")
load("/Users/lesliehuang/kfold_perplexity_65.RData")
View(perplexity_results_60)
load("/Users/lesliehuang/kfold_perplexity_70.RData")
load("/Users/lesliehuang/kfold_perplexity_75.RData")
load("/Users/lesliehuang/kfold_perplexity_80.RData")
View(perplexity_results_55)
save.image("perplexity_kfold_combined.RData")
load("/Users/lesliehuang/kfold_perplexity_40.RData")
save(tab, file = "test.RData")
View(tab)
load("~/un-analysis/full_tm_workspace.RData")
model_75
model_75$gamma
model_75@gamma
View(model_75@gamma)
topic_distr_over_docs <- model_75@gamma
write.csv(topic_distr_over_docs, file = "topic_distr_over_docs_75.csv")
colMeans(topic_distr_over_docs)
max(colMeans(topic_distr_over_docs))
qplot(seq(1,75,1), colMeans(topic_distr_over_docs), xlab = "Topic number", ylab = "Mean proportion of documents") + geom_line() + ggtitle("Mean topic distribution over documents")
library(ggplot2)
qplot(seq(1,75,1), colMeans(topic_distr_over_docs), xlab = "Topic number", ylab = "Mean proportion of documents") + geom_line() + ggtitle("Mean topic distribution over documents")
qplot(seq(1,75,1), colMeans(topic_distr_over_docs), xlab = "Topic number", ylab = "Mean proportion of documents") + geom_point() + ggtitle("Mean topic distribution over documents")
ggsave("topicdistr.png", device = "png")
qplot(seq(1,75,1), colMeans(topic_distr_over_docs), xlab = "Topic number", ylab = "Mean proportion of documents (0.01 = 1%)") + geom_point() + ggtitle("Mean topic distribution over documents")
ggsave("topicdistr.png", device = "png")
qplot(seq(1,75,1), mean_topic_distr, xlab = "Topic number", ylab = "Mean proportion of documents (0.01 = 1%)") + geom_point() + ggtitle("Mean topic distribution over documents")
mean_topic_distr <- colMeans(topic_distr_over_docs)
qplot(seq(1,75,1), mean_topic_distr, xlab = "Topic number", ylab = "Mean proportion of documents (0.01 = 1%)") + geom_point() + ggtitle("Mean topic distribution over documents")
ggsave("topicdistr.png", device = "png")
qplot(seq(1,65,1), colMeans(model_65@gamma), xlab = "Topic number", ylab = "Mean proportion of documents (0.01 = 1%)") + geom_point() + ggtitle("Mean topic distribution over documents")
qplot(seq(1,75,1), mean_topic_distr, xlab = "Topic number", ylab = "Mean proportion of documents (0.01 = 1%)") + geom_point() + ggtitle("Mean topic distribution over documents with 75 topics")
ggsave("topicdistr.png", device = "png")
qplot(seq(1,65,1), colMeans(model_65@gamma), xlab = "Topic number", ylab = "Mean proportion of documents (0.01 = 1%)") + geom_point() + ggtitle("Mean topic distribution over documents with 65 topics")
load("/Users/lesliehuang/un_findk_110.RData")
load("/Users/lesliehuang/un_findk_120.RData")
load("/Users/lesliehuang/un_findk_130.RData")
load("/Users/lesliehuang/un_findk_140.RData")
load("/Users/lesliehuang/un_findk_150.RData")
load("/Users/lesliehuang/un_findk_160.RData")
load("/Users/lesliehuang/un_findk_170.RData")
load("/Users/lesliehuang/un_findk_180.RData")
load("/Users/lesliehuang/un_findk_190.RData")
load("/Users/lesliehuang/un_findk_200.RData")
load("/Users/lesliehuang/un_findk_210.RData")
load("/Users/lesliehuang/un_findk_220.RData")
load("/Users/lesliehuang/un_findk_230.RData")
load("/Users/lesliehuang/un_findk_240.RData")
load("/Users/lesliehuang/un_findk_250.RData")
load("/Users/lesliehuang/un_findk_270.RData")
save.image("moretuning.RData")
load("/Users/lesliehuang/un_findk_260.RData")
load("/Users/lesliehuang/un_findk_280.RData")
load("/Users/lesliehuang/un_findk_290.RData")
save.image("moretuning.RData")
load("/Users/lesliehuang/un_findk_96.RData")
load("/Users/lesliehuang/un_findk_95.RData")
load("/Users/lesliehuang/un_findk_93.RData")
load("/Users/lesliehuang/un_findk_92.RData")
load("/Users/lesliehuang/un_findk_91.RData")
load("/Users/lesliehuang/un_findk_90.RData")
load("/Users/lesliehuang/un_findk_89.RData")
load("/Users/lesliehuang/un_findk_88.RData")
load("/Users/lesliehuang/un_findk_87.RData")
load("/Users/lesliehuang/un_findk_86.RData")
load("/Users/lesliehuang/un_findk_84.RData")
load("/Users/lesliehuang/un_findk_82.RData")
load("/Users/lesliehuang/un_findk_81.RData")
load("/Users/lesliehuang/un_findk_80.RData")
load("/Users/lesliehuang/un_findk_78.RData")
load("/Users/lesliehuang/un_findk_79.RData")
load("/Users/lesliehuang/un_findk_45.RData")
load("/Users/lesliehuang/un_findk_75.RData")
load("/Users/lesliehuang/un_findk_20.RData")
load("/Users/lesliehuang/un_findk_25.RData")
load("/Users/lesliehuang/un_findk_28.RData")
load("/Users/lesliehuang/un_findk_29.RData")
load("/Users/lesliehuang/un_findk_43.RData")
load("/Users/lesliehuang/un_findk_44.RData")
load("/Users/lesliehuang/un_findk_47.RData")
load("/Users/lesliehuang/un_findk_50.RData")
load("/Users/lesliehuang/un_findk_51.RData")
load("/Users/lesliehuang/un_findk_53.RData")
load("/Users/lesliehuang/un_findk_56.RData")
load("/Users/lesliehuang/un_findk_58.RData")
load("/Users/lesliehuang/un_findk_60.RData")
load("/Users/lesliehuang/un_findk_62.RData")
load("/Users/lesliehuang/un_findk_63.RData")
load("/Users/lesliehuang/un_findk_64.RData")
load("/Users/lesliehuang/un_findk_65.RData")
load("/Users/lesliehuang/un_findk_66.RData")
load("/Users/lesliehuang/un_findk_67.RData")
load("/Users/lesliehuang/un_findk_68.RData")
load("/Users/lesliehuang/un_findk_69.RData")
load("/Users/lesliehuang/un_findk_70.RData")
load("/Users/lesliehuang/un_findk_72.RData")
load("/Users/lesliehuang/un_findk_73.RData")
load("/Users/lesliehuang/un_findk_74.RData")
load("/Users/lesliehuang/un_findk_76.RData")
load("/Users/lesliehuang/un_findk_77.RData")
View(tab)
save.image("un_tuning_combined.RData")
load("/Users/lesliehuang/un_findk_52.RData")
load("/Users/lesliehuang/un_findk_26.RData")
load("/Users/lesliehuang/un_findk_39.RData")
load("/Users/lesliehuang/un_findk_42.RData")
load("/Users/lesliehuang/un_findk_37.RData")
load("/Users/lesliehuang/un_findk_49.RData")
load("/Users/lesliehuang/un_findk_54.RData")
load("/Users/lesliehuang/un_findk_57.RData")
load("/Users/lesliehuang/un_model_75.RData")
load("/Users/lesliehuang/un_findk_42.RData")
load("/Users/lesliehuang/un_findk_22.RData")
load("/Users/lesliehuang/un_findk_23.RData")
load("/Users/lesliehuang/un_findk_26.RData")
load("/Users/lesliehuang/un_findk_32.RData")
load("/Users/lesliehuang/un_findk_31.RData")
load("/Users/lesliehuang/un_findk_49.RData")
load("/Users/lesliehuang/un_findk_33.RData")
load("/Users/lesliehuang/un_findk_35.RData")
load("/Users/lesliehuang/un_findk_36.RData")
load("/Users/lesliehuang/un_findk_37.RData")
load("/Users/lesliehuang/un_findk_38.RData")
load("/Users/lesliehuang/un_findk_39.RData")
load("/Users/lesliehuang/un_findk_40.RData")
load("/Users/lesliehuang/un_findk_46.RData")
load("/Users/lesliehuang/un_findk_52.RData")
load("/Users/lesliehuang/un_findk_54.RData")
load("/Users/lesliehuang/un_findk_57.RData")
load("/Users/lesliehuang/un_findk_100.RData")
load("/Users/lesliehuang/un_findk_40.RData")
save.image("un_tuning_combined.RData")
load("/Users/lesliehuang/un_findk_34.RData")
load("/Users/lesliehuang/un_tuning_combined.RData")
save.image("un_tuning_combined.RData")
load("/Users/lesliehuang/un_findk_110.RData")
load("/Users/lesliehuang/un_findk_99.RData")
save.image("un_tuning_combined.RData")
load("/Users/lesliehuang/un_findk_135.RData")
load("/Users/lesliehuang/un_findk_97.RData")
load("/Users/lesliehuang/un_findk_140.RData")
save.image("un_tuning_combined.RData")
load("/Users/lesliehuang/kfold_perplexity_41.RData")
load("/Users/lesliehuang/kfold_perplexity_42.RData")
load("/Users/lesliehuang/kfold_perplexity_43.RData")
load("/Users/lesliehuang/kfold_perplexity_44.RData")
load("/Users/lesliehuang/kfold_perplexity_46.RData")
load("/Users/lesliehuang/kfold_perplexity_45.RData")
load("/Users/lesliehuang/kfold_perplexity_47.RData")
load("/Users/lesliehuang/kfold_perplexity_48.RData")
save.image("perplexity_kfold_combined.RData")
load("/Users/lesliehuang/un_findk_150.RData")
load("/Users/lesliehuang/un_findk_24.RData")
load("/Users/lesliehuang/un_findk_155.RData")
load("/Users/lesliehuang/un_findk_145.RData")
load("/Users/lesliehuang/un_findk_21.RData")
load("/Users/lesliehuang/un_findk_160.RData")
load("/Users/lesliehuang/un_findk_165.RData")
load("/Users/lesliehuang/un_findk_170.RData")
save.image("un_tuning_combined.RData")
load("/Users/lesliehuang/kfold_perplexity_51.RData")
load("/Users/lesliehuang/kfold_perplexity_40.RData")
load("/Users/lesliehuang/kfold_perplexity_50.RData")
load("/Users/lesliehuang/kfold_perplexity_52.RData")
load("/Users/lesliehuang/kfold_perplexity_49.RData")
load("/Users/lesliehuang/kfold_perplexity_53.RData")
load("/Users/lesliehuang/kfold_perplexity_54.RData")
load("/Users/lesliehuang/kfold_perplexity_55.RData")
load("/Users/lesliehuang/kfold_perplexity_56.RData")
load("/Users/lesliehuang/kfold_perplexity_57.RData")
load("/Users/lesliehuang/kfold_perplexity_58.RData")
save.image("perplexity_kfold_combined.RData")
load("/Users/lesliehuang/un_tuning_combined.RData")
load("/Users/lesliehuang/un_findk_175.RData")
load("/Users/lesliehuang/un_findk_105.RData")
load("/Users/lesliehuang/un_findk_41.RData")
load("/Users/lesliehuang/un_findk_61.RData")
load("/Users/lesliehuang/un_findk_190.RData")
load("/Users/lesliehuang/un_findk_240.RData")
load("/Users/lesliehuang/un_findk_250.RData")
load("/Users/lesliehuang/un_findk_290.RData")
save.image("un_tuning_combined.RData")
load("/Users/lesliehuang/kfold_perplexity_61.RData")
load("/Users/lesliehuang/kfold_perplexity_68.RData")
load("/Users/lesliehuang/kfold_perplexity_63.RData")
save.image("perplexity_kfold_combined.RData")
View(perplexity_results_47)
load("/Users/lesliehuang/un_findk_210.RData")
load("/Users/lesliehuang/un_findk_215.RData")
load("/Users/lesliehuang/un_findk_265.RData")
load("/Users/lesliehuang/un_findk_180.RData")
load("/Users/lesliehuang/un_findk_205.RData")
load("/Users/lesliehuang/un_findk_295.RData")
save.image("un_tuning_combined.RData")
load("/Users/lesliehuang/kfold_perplexity_86.RData")
load("/Users/lesliehuang/kfold_perplexity_82.RData")
load("/Users/lesliehuang/kfold_perplexity_79.RData")
load("/Users/lesliehuang/kfold_perplexity_77.RData")
load("/Users/lesliehuang/kfold_perplexity_85.RData")
save.image("perplexity_kfold_combined.RData")
load("/Users/lesliehuang/un_tuning_combined.RData")
load("/Users/lesliehuang/un_findk_300.RData")
save.image("un_tuning_combined.RData")
load("full_tm_workspace.RData")
load("/Users/lesliehuang/un-analysis/full_tm_workspace.RData")
View(ldatuning_results)
View(combined_perplexity_results)
load("~/un-analysis/un_base_workspace.RData")
summary(gd_speeches)
un_dfm
View(xtab_df)
rowMeans(xtab_df)
tab
mean(tab$freq)
sd(tab$freq)
summary(un_dfm)
un_dfm
ntoken(un_dfm)
mean(ntoken(un_dfm))
sd(ntoken(un_dfm))
mean(nfeature(un_dfm))
nfeature_un_dfm
nfeature(un_dfm)
mean(ntype(un_dfm))
sd(ntype(un_dfm))
# Leslie Huang
### Set up the workspace
rm(list=ls())
setwd("/Users/lesliehuang/un-analysis/")
# Bring all the results together
load("analysis_of_models.RData")
load("un_ldatuning_results.RData")
load("perplexity_kfold_combined.RData")
set.seed(1234)
libraries <- c("foreign", "utils", "dplyr", "plyr", "devtools", "quanteda", "ggplot2", "topicmodels", "lda", "ldatuning", "LDAvis", "stringi")
lapply(libraries, require, character.only=TRUE)
# Examine models with different k
# Sparsity for DFM: min = 0.5%, max = 90%
# TM settings: 5 starts, 4000 iter, 1000 burnin, 500 thin
# Plot the results from LDAtuning
ldatuning_20_100 <- dplyr::filter(ldatuning_results, topics <= 100)
par(mfrow=c(1,1))
plot.new()
png("tuning_plot_20_100.png", width = 1500, height = 1000)
tuning_plot <- FindTopicsNumber_plot(ldatuning_20_100[, c(1, 3:5)])
# exclude Griffiths because it's NA
dev.off()
ldatuning_by5 <- dplyr::filter(ldatuning_results, grepl("5$", topics) | grepl("0$", topics))
png("tuning_plot_by5.png", width = 1500, height = 1000)
tuning_plot <- FindTopicsNumber_plot(ldatuning_by5[, c(1, 3:5)]) # exclude Griffiths because it's NA
dev.off()
# Plot the results from 10-fold heldout perplexity
qplot(seq(40,90,1), combined_perplexity_results$mean_log, xlab = "Number of topics", ylab = "Mean of log held-out perplexity") + geom_line() + ggtitle("Results from held-out perplexity from 10-fold cross-validation")
ggsave("logperplexity_results.png", device = "png")
qplot(seq(1,75,1), mean_topic_distr, xlab = "Topic number", ylab = "Mean proportion (0.01 = 1%)") + geom_point() + ggtitle("Mean topic distribution over documents with 75 topics")
ggsave("topicdistr.png", device = "png")
qnorm(95)
qnorm(.95)
mean_topic_distr
sds
View(topic_distr_over_docs)
topic_distr_over_docs[1,]
topic_distr_over_docs[,1]
mean(topic_distr_over_docs[,1])
t.test(topic_distr_over_docs[,1])
x<- t.test(topic_distr_over_docs[,1])
x$conf.int
x$conf.int[1]
x$conf.int[2]
summary_states <- as.matrix(NA, nrow = 4, ncol = 75)
summary_stats <- as.matrix(NA, nrow = 4, ncol = 75)
summary_stats[,2]
summary_stats[,1]
summary_stats
summary_stats <- as.matrix(nrow = 4, ncol = 75)
summary_stats <- as.matrix(NA, nrow = 4, ncol = 75)
summary_stats
summary_stats <- as.matrix(rep(NA, 74), nrow = 4, ncol = 75)
summary_stats
summary_stats <- as.data.frame()
summary_stats <- data.frame(matrix(nrow = 75, ncol = 4))
summary_stats
colnames(summary_stats) <- c("mean", "sd", "ci_lower", "ci_upper")
for (i in 1:ncol(topic_distr_over_docs)) {
topic_mean <- mean(topic_distr_over_docs[,i])
sd <- sd(topic_distr_over_docs[,i])
ttest <- t.test(topic_distr_over_docs[,i], conf.level = 0.95)
conf_lower <- ttest$conf.int[1]
conf_upper <- ttest$conf.int[2]
summary_stats[i, ] <- c(topic_mean, sd, conf_lower, conf_upper)
}
summary_stats
ggplot(summary_stats, aes(x=1:75, y=mean)) +
geom_errorbar(aes(ymin=conf_lower, ymax=conf_upper), width=.1, position=pd) +
geom_line(position=pd) +
geom_point(position=pd)
ggplot(summary_stats, aes(x=1:75, y=mean)) +
geom_errorbar(aes(ymin=conf_lower, ymax=conf_upper), width=.1) +
geom_line() +
geom_point()
ggplot(summary_stats, aes(x=1:75, y=mean)) +
geom_errorbar(aes(ymin=conf_lower, ymax=conf_upper), width=.1) +
geom_point()
ggplot(summary_stats, aes(x=1:75, y=mean)) +
geom_errorbar(aes(ymin=conf_lower, ymax=conf_upper), width= .1) +
geom_point() + ggtitle("Mean topic distribution over documents with 75 topics")
ggsave("topicdistr.png", device = "png")
ggplot(summary_stats, aes(x=1:75, y=mean)) +
#geom_errorbar(aes(ymin=conf_lower, ymax=conf_upper), width= .1) +
geom_ribbon(data= summary_stats,aes(ymin=conf_lower, ymax=conf_upper), alpha=0.3) +
geom_point() + ggtitle("Mean topic distribution over documents with 75 topics")
ggsave("topicdistr.png", device = "png")
ggplot(summary_stats, aes(x = 1:75, y = mean)) +
#stat_summary(geom="ribbon", fun.data=mean_cl_normal, width=0.1, conf.int=0.95, fill="lightblue")+
geom_point() + ggtitle("Mean topic distribution over documents with 75 topics")
ggsave("topicdistr.png", device = "png")
ggplot(summary_stats, aes(x = 1:75, y = mean)) +
stat_summary(geom="ribbon", fun.data=mean_cl_normal, width=0.1, conf.int=0.95, fill="lightblue")+
geom_point() + ggtitle("Mean topic distribution over documents with 75 topics")
ggsave("topicdistr.png", device = "png")
ggplot(summary_stats, aes(x = 1:75, y = mean)) +
geom_errorbar(data = summary_stats, ymin = conf_lower, ymax = conf_upper) +
geom_point() + ggtitle("Mean topic distribution over documents with 75 topics")
ggsave("topicdistr.png", device = "png")
ggplot(summary_stats, aes(x = 1:75, y = mean)) +
geom_errorbar(data = summary_stats, ymin = conf_lower, ymax = conf_upper, width = 0.1) +
geom_point() + ggtitle("Mean topic distribution over documents with 75 topics")
ggsave("topicdistr.png", device = "png")
ggplot(summary_stats, aes(x = 1:75, y = mean)) +
geom_errorbar(data = summary_stats, aes(ymin = conf_lower, ymax = conf_upper, width = 0.1)) +
geom_point() + ggtitle("Mean topic distribution over documents with 75 topics")
ggsave("topicdistr.png", device = "png")
pd <- position_dodge(0.1)
ggplot(summary_stats, aes(x = 1:75, y = mean)) +
geom_errorbar(data = summary_stats, aes(ymin = conf_lower, ymax = conf_upper), width = 0.1, position = pd) +
geom_point(position = pd) + ggtitle("Mean topic distribution over documents with 75 topics")
ggsave("topicdistr.png", device = "png")
x
summary_stats <- data.frame(matrix(nrow = 75, ncol = 5))
colnames(summary_stats) <- c("mean", "sd", "se", "ci_lower", "ci_upper")
for (i in 1:ncol(topic_distr_over_docs)) {
topic_mean <- mean(topic_distr_over_docs[,i])
sd <- sd(topic_distr_over_docs[,i])
se <- sd(topic_distr_over_docs[,i]/sqrt(length(topic_distr_over_docs[,i])))
ttest <- t.test(topic_distr_over_docs[,i], conf.level = 0.95)
conf_lower <- ttest$conf.int[1]
conf_upper <- ttest$conf.int[2]
summary_stats[i, ] <- c(topic_mean, sd, se, conf_lower, conf_upper)
}
pd <- position_dodge(0.1)
ggplot(summary_stats, aes(x = 1:75, y = mean)) +
geom_errorbar(data = summary_stats, aes(ymin = mean - se, ymax = mean + se), width = 0.1, position = pd) +
geom_point(position = pd) + ggtitle("Mean topic distribution over documents with 75 topics")
ggsave("topicdistr.png", device = "png")
# Plot mean with CI
pd <- position_dodge(0.1)
ggplot(summary_stats, aes(x = 1:75, y = mean), xlab = "Topic number (no substantive meaning)", ylab = "Mean proportion (out of 1.0)") +
geom_errorbar(data = summary_stats, aes(ymin = mean - se, ymax = mean + se), width = 0.2, position = pd) +
geom_point(position = pd) + ggtitle("Mean topic distribution over documents, 95% CI")
ggsave("topicdistr.png", device = "png")
# Plot mean with CI
pd <- position_dodge(0.1)
ggplot(summary_stats, aes(x = 1:75, y = mean, xlab = "Topic number (no substantive meaning)", ylab = "Mean proportion (out of 1.0)")) +
geom_errorbar(data = summary_stats, aes(ymin = mean - se, ymax = mean + se), width = 0.2, position = pd) +
geom_point(position = pd) + ggtitle("Mean topic distribution over documents, 95% CI")
ggsave("topicdistr.png", device = "png")
pd <- position_dodge(0.1)
ggplot(summary_stats, aes(x = 1:75, y = mean)) +
xlab("Topic number (no substantive meaning)") +
ylab("Mean proportion (out of 1.0)") +
geom_errorbar(data = summary_stats, aes(ymin = mean - se, ymax = mean + se), width = 0.2, position = pd) +
geom_point(position = pd) + ggtitle("Mean topic distribution over documents, 95% CI")
ggsave("topicdistr.png", device = "png")
load("/Users/lesliehuang/un_findk_260.RData")
save.image("un_tuning_combined.RData")
# Leslie Huang
# Combine all ldatuning results from cluster jobs
### Set up the workspace
rm(list=ls())
setwd("/Users/lesliehuang/un-analysis/")
set.seed(1234)
libraries <- c("foreign", "utils", "dplyr", "plyr", "devtools", "quanteda", "stringi", "topicmodels", "ldatuning", "lda")
lapply(libraries, require, character.only=TRUE)
load("un_tuning_combined.RData")
results <- ls(pattern="^result_")
result <- result_100
for (r in results) {
temp_df <- get(r)
result <- rbind(result, temp_df)
}
ldatuning_results <- unique(result)
rm(results)
rm(r)
rm(list = ls(pattern = "^result_"))
save.image("un_ldatuning_results.RData")
# Leslie Huang
### Set up the workspace
rm(list=ls())
setwd("/Users/lesliehuang/un-analysis/")
# Bring all the results together
load("analysis_of_models.RData")
load("un_ldatuning_results.RData")
load("perplexity_kfold_combined.RData")
set.seed(1234)
libraries <- c("foreign", "utils", "dplyr", "plyr", "devtools", "quanteda", "ggplot2", "topicmodels", "lda", "ldatuning", "LDAvis", "stringi")
lapply(libraries, require, character.only=TRUE)
# Examine models with different k
# Sparsity for DFM: min = 0.5%, max = 90%
# TM settings: 5 starts, 4000 iter, 1000 burnin, 500 thin
# Plot the results from LDAtuning
ldatuning_20_100 <- dplyr::filter(ldatuning_results, topics <= 100)
par(mfrow=c(1,1))
plot.new()
png("tuning_plot_20_100.png", width = 1500, height = 1000)
tuning_plot <- FindTopicsNumber_plot(ldatuning_20_100[, c(1, 3:5)])
# exclude Griffiths because it's NA
dev.off()
ldatuning_by5 <- dplyr::filter(ldatuning_results, grepl("5$", topics) | grepl("0$", topics))
png("tuning_plot_by5.png", width = 1500, height = 1000)
tuning_plot <- FindTopicsNumber_plot(ldatuning_by5[, c(1, 3:5)]) # exclude Griffiths because it's NA
dev.off()
# Plot the results from 10-fold heldout perplexity
qplot(seq(40,90,1), combined_perplexity_results$mean_log, xlab = "Number of topics", ylab = "Mean of log held-out perplexity") + geom_line() + ggtitle("Results from held-out perplexity from 10-fold cross-validation")
ggsave("logperplexity_results.png", device = "png")
# Topic mean with confidence intervals
summary_stats <- data.frame(matrix(nrow = 75, ncol = 5))
colnames(summary_stats) <- c("mean", "sd", "se", "ci_lower", "ci_upper")
for (i in 1:ncol(topic_distr_over_docs)) {
topic_mean <- mean(topic_distr_over_docs[,i])
sd <- sd(topic_distr_over_docs[,i])
se <- 1.96 * sd(topic_distr_over_docs[,i]/sqrt(length(topic_distr_over_docs[,i])))
ttest <- t.test(topic_distr_over_docs[,i], conf.level = 0.95)
conf_lower <- ttest$conf.int[1]
conf_upper <- ttest$conf.int[2]
summary_stats[i, ] <- c(topic_mean, sd, se, conf_lower, conf_upper)
}
# Plot mean with CI
pd <- position_dodge(0.1)
ggplot(summary_stats, aes(x = 1:75, y = mean)) +
xlab("Topic number (no substantive meaning)") +
ylab("Mean proportion (out of 1.0)") +
geom_errorbar(data = summary_stats, aes(ymin = mean - se, ymax = mean + se), width = 0.2, position = pd) +
geom_point(position = pd) + ggtitle("Mean topic distribution over documents, 95% CI")
ggsave("topicdistr.png", device = "png")
# # old plot of just means
# qplot(seq(1,75,1), mean_topic_distr, xlab = "Topic number", ylab = "Mean proportion (0.01 = 1%)") + geom_point() + ggtitle("Mean topic distribution over documents with 75 topics")
# ggsave("topicdistr.png", device = "png")
# get summary stats
mean(tab$freq)
sd(tab$freq)
mean(ntoken(un_dfm))
sd(ntoken(un_dfm))
mean(ntype(un_dfm))
sd(ntype(un_dfm))
save.image("full_tm_workspace.RData")
